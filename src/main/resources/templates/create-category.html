<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Categoria - BlueVelvet Music Store</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
<main>
    <div class="go-back">
        <a href="/dashboard" style="text-decoration: none; color: black; cursor: pointer;">
            <span class="arrow left"></span> Voltar
        </a>
    </div>

    <h1>ðŸŽµ BlueVelvet Music Store</h1>
    <h2>Adicionar Categoria</h2>

    <form enctype="multipart/form-data"
          method="POST"
          th:action="@{/category}"
          th:object="${category}">

        <label for="name">Nome da Categoria</label>
        <input id="name" name="name" placeholder="Nome da Categoria" required th:field="*{name}" type="text">

        <label for="imageFile">Imagem</label>
        <input accept="image/*" id="imageFile" name="imageFile" required onchange="previewImage(event)" type="file">

        <!-- Preview da imagem selecionada -->
        <div id="imagePreview" style="margin: 10px 0; display: none;">
            <small>Preview da imagem:</small><br>
            <img alt="Preview" id="preview" src=""
                 style="max-width: 200px; max-height: 200px; object-fit: contain; border: 1px solid #ddd; border-radius: 5px; padding: 5px;">
        </div>

        <label for="parentId">Categoria Pai (Deixe em branco para categoria raiz)</label>
        <select id="parentId" name="parentId" th:field="*{parentId}">
            <option value="">-- Nenhuma (Raiz) --</option>
            <option th:each="parent : ${parentCategories}"
                    th:text="${parent.name}"
                    th:value="${parent.id}">
            </option>
        </select>

        <fieldset id="enabled">
            <legend>Habilitada</legend>

            <div class="radio-option">
                <input id="yes" name="enabled" th:checked="*{enabled}" th:field="*{enabled}" type="radio" value="true">
                <label for="yes">Sim</label>
            </div>

            <div class="radio-option">
                <input id="no" name="enabled" th:checked="!*{enabled}" th:field="*{enabled}" type="radio" value="false">
                <label for="no">NÃ£o</label>
            </div>
        </fieldset>

        <div class="bottom-buttons">
            <button type="submit">Salvar</button>
            <button onclick="history.back()" type="button">Cancelar</button>
        </div>

    </form>
</main>

<script>
    function previewImage(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                document.getElementById('preview').src = e.target.result;
                document.getElementById('imagePreview').style.display = 'block';
            };
            reader.readAsDataURL(file);
        } else {
            document.getElementById('imagePreview').style.display = 'none';
        }
    }
</script>
</body>
</html>
